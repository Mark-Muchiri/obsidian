!function(){"use strict";!function(){var e=!1,t=!1,o=null,n=!1,i=!1,l={},s=!!window.browser;const c="Hide";let r=null,a=!1;s?browser.storage.sync.get().then(u):chrome.storage.sync.get(null,u);const d=s?browser.runtime:chrome.runtime;function u(e){var t;console.log(e),l={shortcutDisplay:e.shortcutDisplay||"`",shortcutKey:e.shortcutKey||192,autoToggle:e.autoToggle||!1,scrollable:e.scrollable||!1,hideScrollbar:e.hideScrollbar||!1,miniplayer:e.miniplayer||!1,showChromePIP:e.showChromePIP||!1,showVideoTitle:e.showVideoTitle||!1,pipShortcut:e.pipShortcut||!1,hidePaidPromotion:e.hidePaidPromotion||!1,hideMiniplayerButton:e.hideMiniplayerButton||!1},(t={action:"checkAuthState"},new Promise(((e,o)=>{s?d.sendMessage(t).then(e).catch(o):d.sendMessage(t,(t=>{if(chrome.runtime.lastError)return o(chrome.runtime.lastError);e(t)}))}))).then((e=>{console.log("CHECK AUTH RESPONSE",e),e.success&&e.userData&&(e.isPremium||e.isTrialActive)||(console.log("Not Premium"),l.autoToggle=!1,l.scrollable=!1,l.hideScrollbar=!1,l.miniplayer=!1,l.pipShortcut=!1,l.hidePaidPromotion=!1,l.hideMiniplayerButton=!1),console.log("CHECK AUTH COMPLETE"),m()})).catch((e=>{console.error("Error checking auth state:",e),m()}))}function m(){h(),l.hidePaidPromotion&&document.body.classList.add("hide-paid-promotion"),function(){let e;y();const t=()=>{clearTimeout(e),e=setTimeout((()=>{console.log("Navigation event detected"),y()}),100)};["yt-navigate-start","yt-navigate-finish","yt-page-data-updated","popstate"].forEach((e=>{document.body.addEventListener(e,t)}))}()}function h(){document.body.classList.remove("updated-full-mode","scrollable-full","show-chrome-pip")}function y(){if(!f())return h(),void(e&&w());const o=setInterval((()=>{const n=document.querySelector("video[src^='blob:https://www.youtube.com'"),i=document.querySelector("ytd-watch-flexy"),s=document.querySelector("#primary"),c=document.querySelector("#secondary");n&&s&&c&&i&&(t||(console.log("Creating controls"),function(){var o=document.querySelector("#movie_player button.ytp-settings-button"),n=document.getElementsByClassName("ytp-size-button")[0],i=document.getElementsByClassName("ytp-fullscreen-button")[0],s=document.getElementsByClassName("ytp-miniplayer-button")[0],c=o.cloneNode(!0);o.id="settings-cog",n.id="original-size",c.id="full-size";var r=document.getElementsByClassName("ytp-right-controls")[0].insertBefore(c,o);r.title=`Full Browser Mode (${l.shortcutDisplay})`,r.className=n.className+" ytp-button",r.innerHTML='<svg width="20" height="28" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" class="svg-container"><path d="M883 1056q0 13-10 23l-332 332 144 144q19 19 19 45t-19 45-45 19h-448q-26 0-45-19t-19-45v-448q0-26 19-45t45-19 45 19l144 144 332-332q10-10 23-10t23 10l114 114q10 10 10 23zm781-864v448q0 26-19 45t-45 19-45-19l-144-144-332 332q-10 10-23 10t-23-10l-114-114q-10-10-10-23t10-23l332-332-144-144q-19-19-19-45t19-45 45-19h448q26 0 45 19t19 45z" style="fill: white;"></path></svg>',r.addEventListener("click",p),document.addEventListener("fullscreenchange",(function(e){b()})),document.body.addEventListener("keydown",(function(t){if((27===t.keyCode||"Escape"===t.key)&&e&&f()&&w(),"TEXTAREA"==t.target.nodeName||"INPUT"==t.target.nodeName||"YT-FORMATTED-STRING"==t.target.nodeName||"DIV"==t.target.nodeName&&"style-scope yt-formatted-string"==t.target.className);else if(f()){73!==t.keyCode&&"i"!==t.key.toLowerCase()||w();const e=parseInt(l.shortcutKey);if(t.keyCode!==e&&t.key!==l.shortcutDisplay||p(),t.altKey&&"KeyP"===t.code){console.log("PiP shortcut detected");const e=document.querySelector("video[src^='blob:https://www.youtube.com'");e&&(document.pictureInPictureElement?document.exitPictureInPicture():e.requestPictureInPicture())}}})),i?.addEventListener("click",b),s?.addEventListener("click",w),l.hideMiniplayerButton&&s&&document.body.classList.add("hide-miniplayer-button");t=!0}()),t&&l.autoToggle&&(console.log("Attempting auto-toggle"),g()),clearInterval(o))}),500)}function p(){e?w():g()}function g(){var t=document.getElementById("original-size"),s=document.getElementById("full-size"),c=document.querySelector("ytd-watch-grid")||document.querySelector("ytd-watch")||document.querySelector("ytd-watch-flexy")||document.querySelector("#player");if((o=window.matchMedia("(max-width: 882px)")).addListener(v),e=!0,i=c.hasAttribute("theater"),n=i,function e(o=15){o<=0||((t=document.getElementById("original-size"))?(i=c.hasAttribute("theater"))||(console.log("Attempting to enable theater mode..."),t.click(),setTimeout((()=>{(i=c.hasAttribute("theater"))||e(o-1)}),300)):setTimeout((()=>e(o-1)),200))}(),window.scrollTo(0,0),document.body.classList.add("updated-full-mode"),l.scrollable&&(document.body.classList.add("scrollable-full"),l.hideScrollbar&&document.body.classList.add("hide-scrollbar")),l.showChromePIP&&document.body.classList.add("show-chrome-pip"),l.showVideoTitle){const e=document.querySelector("#movie_player");e&&e.classList.remove("ytp-hide-info-bar")}t.style.display="none",s.style.display="inline-block",s.innerHTML='<svg width="20" height="28" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" class="svg-container"><path d="M896 960v448q0 26-19 45t-45 19-45-19l-144-144-332 332q-10 10-23 10t-23-10l-114-114q-10-10-10-23t10-23l332-332-144-144q-19-19-19-45t19-45 45-19h448q26 0 45 19t19 45zm755-672q0 13-10 23l-332 332 144 144q19 19 19 45t-19 45-45 19h-448q-26 0-45-19t-19-45v-448q0-26 19-45t45-19 45 19l144 144 332-332q10-10 23-10t23 10l114 114q10 10 10 23z" style="fill: white;"></path></svg>',v(o),window.dispatchEvent(new Event("resize"))}function w(){var t=document.getElementById("original-size"),i=document.getElementById("full-size");e=!1,document.body.classList.remove("updated-full-mode"),document.body.classList.remove("scrollable-full"),document.body.classList.remove("show-chrome-pip"),document.body.classList.remove("hide-scrollbar"),t.style.display="inline-block",i.style.display="inline-block",i.innerHTML='<svg width="20" height="28" viewBox="0 0 1792 1792" xmlns="http://www.w3.org/2000/svg" class="svg-container"><path d="M883 1056q0 13-10 23l-332 332 144 144q19 19 19 45t-19 45-45 19h-448q-26 0-45-19t-19-45v-448q0-26 19-45t45-19 45 19l144 144 332-332q10-10 23-10t23 10l114 114q10 10 10 23zm781-864v448q0 26-19 45t-45 19-45-19l-144-144-332 332q-10 10-23 10t-23-10l-114-114q-10-10-10-23t10-23l332-332-144-144q-19-19-19-45t19-45 45-19h448q26 0 45 19t19 45z" style="fill: white;"></path></svg>',n||t.click(),o.removeListener(v),window.dispatchEvent(new Event("resize"))}function v(e){document.getElementById("original-size");e.matches}function b(){var t,o=document.getElementById("original-size"),n=document.getElementById("full-size");(t=document.getElementsByClassName("ytp-fullscreen-button")[0])&&"Exit full screen (f)"==t.title?n.style.display="none":(n.style.display="inline-block",e&&(o.style.display="none"))}function f(){return location.pathname.includes("/watch")||location.pathname.includes("/live/")||location.pathname.includes("/clip/")}const E=document.createElement("button");E.className="top-btn yt-spec-button-shape-next",E.innerText="Go to Top";const q=document.createElement("button");q.className="toggle-btn yt-spec-button-shape-next",q.innerHTML=c,E.addEventListener("click",(function(){window.scrollTo(0,0)})),q.addEventListener("click",(function(){a&&r&&(r.classList.contains("miniplayer-hide")?(r.classList.remove("miniplayer-hide"),q.innerHTML=c):(r.classList.add("miniplayer-hide"),q.innerHTML="Show"))})),window.addEventListener("scroll",(function(){const e=document.getElementById("masthead-container");if(window.scrollY>=100?e.classList.add("show"):0==this.window.scrollY&&e.classList.remove("show"),l.miniplayer&&window.scrollY>window.innerHeight-100){if(!a){if(r=r??document.getElementById("movie_player"),!r)return;r.appendChild(E),r.appendChild(q),r.classList.add("miniplayer","ytp-small-mode"),window.dispatchEvent(new Event("resize")),a=!0}}else a&&(r.classList.remove("miniplayer","ytp-small-mode"),window.dispatchEvent(new Event("resize")),a=!1)}),!1)}()}();
